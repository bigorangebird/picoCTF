# Get Cookies
- Category : Web Exploitation
- Points 40

### Description

Who doesn't love cookies? Try to figure out the best one. http://mercury.picoctf.net:6418/


### Downloads
None

### Hints

None


## Overview

Far from obvious what needs to happen; so just need to take the implications from the description and try to figure it out. Messing with the cookie value until we trigger the challenge flag.


## Steps

1. First, let's take a look at what the server gives us by loading the link into our browser

   Not much going on ... but we are asked to input the name of a cookie ... and depending on our input we get a slightly different response. Sometimes it tells us that our input isn't a valid cookie - other input tells us that it's not a special cookie.


2. Ok, so let's fire up the browser dev tools and see what cookies are being set by this website

   Just the one cookie ... 'name'

   The cookie value seems to correlate to the messages that appear on screen.

   It is set to -1 when the "cookie input" is deemed invalid
   It is set to 0 when the "cookie input" is snickerdoodle
   It is set to 4 when the "cookie input" is shortbread


3. So, can we influence the message displayed simply by changing the value of the 'name cookie'

   It would appear so ... when I change the value of the cookie 'name' to 16, and refresh the page, the message on screen says that Pinwheel cookies aren't very special.


4. Ok, so let's iterate through some values for "name"

   Changing to 99 causes the 'invalid cookie' message to appear and the 'name' cookie is set to 99. As does 98, 97 and 96 ... so maybe there is an upper limit.

   Trying 70, 50, 40 and 30 do the same.

   28 seems to be the highest number deemed to be valid (white chocolate macadamia cookies) but still not special enough.

   So, we need to work our way through the list from 1...28


5. It was setting the "name" cookie value to 18 that the trick ... displaying the challenge flag onscreen instead of a message about edible cookies.

   picoCTF{3v3ry1_l0v3s_c00k135_*******}

  Cut and paste the displayed flag into the picoCTF window to gain the credit




### Side Notes

1. Not sure what we'd have gained by using BurpSuite!
